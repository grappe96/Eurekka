# React의 class 와  function style coding

참고 강의 : https://www.youtube.com/watch?v=iY_vmP-Q3Ak&list=PLuHgQVnccGMCEfBwnNGsJCQDiqSWI-edj

---

16.8 버전부터 `Hook`을 제공하면서 Function에서도 내부적으로 state 사용이 가능하고, component life cycle에 따라 해야하는 작업을 정의할 수 있다.

react는 function style과 class style을 모두 지원한다.

### props

---

```react
import React from 'react';

// 다른 component를 사용하는 component
function App() {
    return(
        <div className="container">
            <FuncComp initNumber={2}></FuncComp>
        	<classComp initNumber={2}></classComp>
        </div>
    );
}

// function
function FuncComp(props) {
    // react가 호출할 때 첫번째 parameter는 전달된 props 값
    return (
        <div>
        	props : {props.initNumber}
        </div>
    );
}

// class
class ClassComp extends React.Component{
    render() {
        return (
            <div>
            	props : {this.props.initNumber}
            </div>
        );
    }
}
```



### Hook

---

내장된 hook과 사용자 정의 hook이 있다.

내장된 hook은 use로 시작한다.

### 1. useState

class의 state를 function에서 사용

```react
// import React, { useState } from 'react'; 로 import 해야 함

var numberState = useState(props.initNumber);
var number = numberState[0]; // state 값
var setNumber = numberState[1]; // state를 바꿀 수 있는 함수
```

다음과 같이 한 줄로도 작성 가능

```react
var [number, setNumber] = useState(props.initNumber);
```

button onClick의 callback 함수로 setNumber 등록

```react
<input type="button" value="random" onClick={
        function () {
            setNumber(Math.random());
        }
    }></input>
```



동일한 동작을 하는 class style code

```react
state = {
	number = this.props.initNumber;
}

...

<input type="button" value="random" onClick={
    function () {
        this.setState({number: Math.random()})
    }.bind(this)
}></input>
```



### 2. useEffect

여기서 effect는 side effect를 말하는데, 

component의 return을 main effect, 그 외의 것들을 side effect 라고 본다.



### 2-1. componentDidMount

컴포넌트가 생성된 후 할 일을 정의할 때 사용한다.

예를 들어 mount 후 추가적으로 DOM을 처리할 때나 네트워크 위에서 data를 다운받아 처리할 때 사용한다.

```react
// []가 비어있는 경우 최초 한 번만 실행된다.
useEffect(function() {
    document.title = number;
    return function () {
        // component가 소멸될 때 한 번만 실행된다.
    }
}, []);
```
동일한 동작을 하는 class style code

```react
componentDidMount() {
    document.title = number;
}
```

### 2-2. componentDidMount & componentDidUpdate

component는 state에 변동이 있을 때 update된다. (ex) new props, setState(), force Update()

```react
// component가 mount될 때와 update될 때마다 실행된다.
useEffect(function() {
    document.title = number;
});
```

동일한 동작을 하는 class style code

```react
// 두 method에 같은 code를 작성하는 것과 동일한 효과이다.
componentDidMount() {
    document.title = number;
}

componentDidUpdate() {
    document.title = number;
}
```

### 2-3. Effect 생략으로 성능 최적화

해당 callback 함수가 작동하는 경우를 [] 안의 인자값이 변동하는 경우로 한정

```react
// [] 안의 인자값에 변동이 있을 때만 실행
useEffect(function() {
    document.title = number;
}, [number]);
```

[] 안의 인자값을 다르게 하여 useEffect를 여러 개 사용하는 경우 각각 동작함

```react
// number라는 state값에 변동이 있을 때만 실행
useEffect(function() {
    document.title = number;
}, [number]);

// _date라는 state값에 변동이 있을 때만 실행
useEffect(function() {
    document.title = _date;
}, [_date]);
```

### 2-4. componentWillUnmount

component가 사라질 때 필요한 작업을 정의한다. (clean up)

```react
// component가 mount될 때, update될 때마다 실행
useEffect(function() {
   return function(){
       // useEffect가 재실행 되기 전에 실행
   } 
});
```

```react
// component가 mount될 때, number state가 update될 때마다 실행
useEffect(function() {
   return function(){
       // number state가 update될 때 useEffect가 재실행 되기 전 실행
   } 
}, [number]);
```

```react
// component가 mount될 때 최초 한 번 실행
useEffect(function() {
   return function(){
       // component가 소멸될 때 실행
   } 
}, []);
```

동일한 동작을 하는 class style code

```react
componentWillUnmount() {
	return function(){
       // component가 소멸될 때 실행
   }
}
```
